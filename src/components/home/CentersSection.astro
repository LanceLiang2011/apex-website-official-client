---
import type { Locale } from '../../data/types';
import { centers } from '../../data/centers';
import { courses } from '../../data/courses';
import { getRelativeLocaleUrl } from 'astro:i18n';
import { content as siteContent } from '../../data/content';
import GlassmorphicBox from '../GlassmorphicBox.astro';

interface Props {
  locale: Locale;
}
const { locale } = Astro.props;

// Helper to get featured courses for a center
function getCenterCourses(centerId: string) {
  return courses
    .filter(c => c.centerId === centerId)
    .slice(0, 3);
}

const centersContent = siteContent.home.centers;
const commonButtons = siteContent.common.buttons;
---

<section class="py-20 bg-bg-light" id="centers-section">
  <div class="container mx-auto px-4">
    <div class="text-center mb-10">
      <h2 class="text-3xl md:text-4xl font-bold text-text-main mb-4">
        {centersContent.heading[locale]}
      </h2>
      <p class="text-gray-600 max-w-2xl mx-auto">
        {centersContent.subheading[locale]}
      </p>
    </div>

    <!-- Modern Grid with Glassmorphic Overlay -->
    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
      {centers.map((center, index) => {
        const centerCourses = getCenterCourses(center.id);
        // Placeholder images for background
        const bgImage = [
            'https://images.unsplash.com/photo-1523240795612-9a054b0db644?q=80&w=2070&auto=format&fit=crop',
            'https://images.unsplash.com/photo-1522202176988-66273c2fd55f?q=80&w=2071&auto=format&fit=crop',
            'https://images.unsplash.com/photo-1524178232363-1fb2b075b655?q=80&w=2070&auto=format&fit=crop'
        ][index];

        return (
          <div class="group relative h-[450px] rounded-2xl overflow-hidden shadow-lg border border-gray-100">
            <!-- Background Image -->
            <div class="absolute inset-0">
              <img src={bgImage} alt={center.name[locale]} class="w-full h-full object-cover transition-transform duration-700 group-hover:scale-110" />
            </div>
            
            <!-- Glassmorphic overlay covering entire image -->
            <!-- Using dark glass for better text visibility (bgOpacity=70) -->
            <GlassmorphicBox class="absolute inset-0 transition-all duration-300" blur="md" bgOpacity={70} borderOpacity={20} mode="dark">
              <!-- Content centered -->
              <div class="absolute inset-0 p-8 flex flex-col justify-center items-center text-center">
                <h3 class="text-2xl font-bold text-white mb-4">{center.name[locale]}</h3>
                <p class="text-gray-100 text-sm mb-6 max-w-sm mx-auto leading-relaxed">
                  {center.description[locale]}
                </p>
                
                <!-- Course Links -->
                <div class="space-y-2 mb-8 w-full max-w-xs mx-auto">
                  {centerCourses.map(course => (
                    <a 
                      href={getRelativeLocaleUrl(locale, `${center.slug}/courses/${course.slug}`)}
                      class="block text-sm text-white/90 hover:text-white hover:bg-white/10 rounded px-2 py-1 transition-colors flex items-center justify-center"
                    >
                      <svg class="w-3 h-3 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg>
                      {course.name[locale]}
                    </a>
                  ))}
                </div>

                <a 
                  href={getRelativeLocaleUrl(locale, center.slug)} 
                  class="inline-flex items-center justify-center bg-accent-red hover:bg-red-700 text-white font-semibold px-6 py-2.5 rounded-full text-sm transition-all duration-300 shadow-lg hover:shadow-xl transform hover:-translate-y-0.5"
                >
                  {commonButtons.enterCenter[locale]}
                </a>
              </div>
            </GlassmorphicBox>
          </div>
        );
      })}
    </div>

  </div>
</section>
