---
import { content } from '../../data/content';
import type { Locale } from '../../data/types';

interface Props {
  locale: Locale;
}

const { locale } = Astro.props;
const { steps, heading } = content.serviceProcess;

const topRow = steps.slice(0, 6);
const bottomRow = steps.slice(6, 12);

// Icon mapping
const icons: Record<string, string> = {
  chat: `<svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"></path></svg>`,
  document: `<svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg>`,
  folder: `<svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"></path></svg>`,
  bulb: `<svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path></svg>`,
  edit: `<svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path></svg>`,
  send: `<svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8"></path></svg>`,
  user: `<svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path></svg>`,
  check: `<svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>`,
  passport: `<svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"></path></svg>`,
  plane: `<svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8"></path></svg>`, 
  degree: `<svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M12 14l9-5-9-5-9 5 9 5z"/><path d="M12 14l6.16-3.422a12.083 12.083 0 01.665 6.479A11.952 11.952 0 0012 20.055a11.952 11.952 0 00-6.824-2.998 12.078 12.078 0 01.665-6.479L12 14z"/></svg>`,
  rocket: `<svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path></svg>`
};
---

<section class="py-20 relative bg-[#1f2937] text-white overflow-hidden">
  <div class="container mx-auto px-4 relative z-10">
    <div class="flex items-center mb-16">
      <div class="w-1 h-8 bg-accent-red mr-4"></div>
      <h2 class="text-3xl font-bold text-white tracking-wider">
        {heading[locale]}
      </h2>
    </div>

    <div class="max-w-7xl mx-auto">
      <!-- Desktop: Snake Layout -->
      <div class="hidden lg:block relative pb-20">
        
        <!-- Connecting Line Layer -->
        <!-- Top Line: Center of Item 1 to Center of Item 6 -->
        <div class="absolute top-[3rem] left-[8.33%] right-[8.33%] h-[2px] bg-gray-500"></div>
        <!-- Right Curve: From Item 6 Down to Item 7 -->
        <div class="absolute top-[3rem] right-[8.33%] w-[2px] h-[24rem] bg-gray-500 rounded-b-full">
            <div class="absolute bottom-0 -right-2 w-6 h-6 rotate-45 border-r-[2px] border-b-[2px] border-gray-500 transform translate-y-[2px]"></div> <!-- Arrowhead -->
        </div>
        <!-- Bottom Line: Center of Item 7 to Center of Item 12 -->
        <div class="absolute top-[27rem] left-[8.33%] right-[8.33%] h-[2px] bg-gray-500"></div>

        <!-- Row 1 (L -> R) -->
        <div class="grid grid-cols-6 mb-32 relative z-10">
          {topRow.map((step) => (
            <div class="flex flex-col items-center group">
              <!-- Icon Circle -->
              <div class="w-24 h-24 rounded-full bg-white border-4 border-accent-red flex items-center justify-center text-primary-blue mb-8 shadow-lg group-hover:scale-110 transition-transform duration-300 relative z-10">
                <Fragment set:html={icons[step.icon] || icons.chat} />
              </div>
              <!-- Text Box -->
              <div class="bg-white/10 backdrop-blur-md border border-white/20 p-5 rounded-lg w-10/12 text-center h-32 flex flex-col justify-center shadow-lg hover:bg-white/20 transition-colors">
                 <h3 class="text-accent-red font-bold text-lg mb-2">{step.title[locale]}</h3>
                 <p class="text-xs text-gray-300 text-opacity-90">{step.description[locale]}</p>
              </div>
            </div>
          ))}
        </div>

        <!-- Row 2 (R -> L) -->
        <!-- We reverse the array for display so it visually flows R->L IF we used flex-row-reverse, 
             but grid-cols-6 lays out L->R.
             To achieve Visual Snake (7 under 6, 8 under 5... 12 under 1):
             Layout:
             Row 1: 1, 2, 3, 4, 5, 6
             Row 2: 12, 11, 10, 9, 8, 7
        -->
        <div class="grid grid-cols-6 relative z-10">
           {bottomRow.slice().reverse().map((step) => (
            <div class="flex flex-col items-center group">
               <!-- Icon Circle -->
               <div class="w-24 h-24 rounded-full bg-white border-4 border-accent-red flex items-center justify-center text-primary-blue mb-8 shadow-lg group-hover:scale-110 transition-transform duration-300 relative z-10">
                 <Fragment set:html={icons[step.icon] || icons.chat} />
               </div>
               <!-- Text Box -->
               <div class="bg-white/10 backdrop-blur-md border border-white/20 p-5 rounded-lg w-10/12 text-center h-32 flex flex-col justify-center shadow-lg hover:bg-white/20 transition-colors">
                  <h3 class="text-accent-red font-bold text-lg mb-2">{step.title[locale]}</h3>
                  <p class="text-xs text-gray-300 text-opacity-90">{step.description[locale]}</p>
               </div>
            </div>
           ))}
        </div>
      </div>

      <!-- Mobile/Tablet: Vertical Timeline -->
      <div class="lg:hidden relative">
         <div class="absolute left-8 top-8 bottom-8 w-0.5 bg-gray-500"></div>
         <div class="space-y-12 pl-2">
            {[...topRow, ...bottomRow].map((step) => (
               <div class="flex items-start group relative">
                  <div class="w-16 h-16 rounded-full bg-white border-4 border-accent-red flex items-center justify-center text-primary-blue shadow-lg flex-shrink-0 relative z-10">
                     <Fragment set:html={icons[step.icon] || icons.chat} />
                  </div>
                  <div class="ml-6 bg-white/10 backdrop-blur-md border border-white/20 p-5 rounded-lg flex-grow shadow-lg">
                     <h3 class="text-accent-red font-bold text-lg mb-1">{step.title[locale]}</h3>
                     <p class="text-sm text-gray-300">{step.description[locale]}</p>
                  </div>
               </div>
            ))}
         </div>
      </div>

    </div>
  </div>
</section>
